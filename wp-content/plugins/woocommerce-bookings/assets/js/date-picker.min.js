jQuery(document).ready(function(a){function b(b){var c=a(this).closest("form"),d=a(this).data("availability"),e=a(this).data("default-availability"),f=a(this).data("fully-booked-days"),g=wc_bookings_booking_form.check_availability_against;if(c.find("select#wc_bookings_field_resource").val()>0)var h=c.find("select#wc_bookings_field_resource").val();else var h=0;var i=wc_bookings_booking_form.booking_duration,j=new Date(b),k=j.getFullYear(),l=j.getMonth()+1,m=j.getDate();if(f[k+"-"+l+"-"+m]&&(f[k+"-"+l+"-"+m][0]||f[k+"-"+l+"-"+m][h]))return[!1,"fully_booked",booking_form_params.i18n_date_unavailable];if(""+k+l+m<wc_bookings_booking_form.current_time)return[!1,"not_bookable",""];if(c.find("#wc_bookings_field_duration").size()>0&&"minute"!=wc_bookings_booking_form.duration_unit&&"hour"!=wc_bookings_booking_form.duration_unit)var n=c.find("#wc_bookings_field_duration").val(),o=i*n;else var o=i;(1>o||"start"==g)&&(o=1);for(var p=e,q=0;o>q;q++){var j=new Date(b);j.setDate(j.getDate()+q);var k=j.getFullYear(),l=j.getMonth()+1,m=j.getDate(),r=j.getDay(),s=a.datepicker.iso8601Week(j);if(p=e,0==r&&(r=7),a.each(d[h],function(a,b){var c=b[0],d=b[1];try{switch(c){case"months":if("undefined"!=typeof d[l])return p=d[l],!1;break;case"weeks":if("undefined"!=typeof d[s])return p=d[s],!1;break;case"days":if("undefined"!=typeof d[r])return p=d[r],!1;break;case"custom":if("undefined"!=typeof d[k][l][m])return p=d[k][l][m],!1}}catch(e){}return!0}),f[k+"-"+l+"-"+m]&&(f[k+"-"+l+"-"+m][0]||f[k+"-"+l+"-"+m][h])&&(p=!1),!p)break}return p?[p,"bookable",""]:[p,"not_bookable",""]}function c(b){var c=a(this).closest("fieldset"),d=c.find(".picker"),e=a(this).closest("form");"always_visible"!==d.data("display")&&a(this).hide(),b=b.split("-"),c.find("input.booking_date_year").val(b[0]),c.find("input.booking_date_month").val(b[1]),c.find("input.booking_date_day").val(b[2]).change(),e.find(".wc-bookings-booking-form").trigger("date-selected",b)}function d(d){a(d).empty().removeClass("hasDatepicker").datepicker({dateFormat:a.datepicker.ISO_8601,showWeek:!1,showOn:"both",beforeShowDay:b,onSelect:c,minDate:a(d).data("min_date"),maxDate:a(d).data("max_date"),numberOfMonths:1,showButtonPanel:!1,showOtherMonths:!0,selectOtherMonths:!0,closeText:wc_bookings_booking_form.closeText,currentText:wc_bookings_booking_form.currentText,monthNames:wc_bookings_booking_form.monthNames,monthNamesShort:wc_bookings_booking_form.monthNamesShort,dayNames:wc_bookings_booking_form.dayNames,dayNamesShort:wc_bookings_booking_form.dayNamesShort,dayNamesMin:wc_bookings_booking_form.dayNamesMin,firstDay:wc_bookings_booking_form.firstDay,gotoCurrent:!0}),a(".ui-datepicker-current-day").removeClass("ui-datepicker-current-day")}a(".wc-bookings-date-picker legend small.wc-bookings-date-picker-choose-date").show().click(function(){a(this).closest("fieldset").find(".picker").slideToggle()}),a(".wc-bookings-date-picker").each(function(){var b=a(this).find(".picker"),c=a(this).closest("fieldset");d(b),"always_visible"==b.data("display")?(a(".wc-bookings-date-picker-date-fields",c).hide(),a(".wc-bookings-date-picker-choose-date",c).hide()):b.hide()}),a(".booking_date_year, .booking_date_month, .booking_date_day").bind("input",function(){var b=a(this).closest("fieldset"),c=b.find(".picker"),d=parseInt(b.find("input.booking_date_year").val(),10),e=parseInt(b.find("input.booking_date_month").val(),10),f=parseInt(b.find("input.booking_date_day").val(),10),g=a(this).closest("form");if(d&&e&&f){var h=new Date(d,e,f);c.datepicker("setDate",h),g.find(".wc-bookings-booking-form").trigger("date-selected",h)}}),a("#wc_bookings_field_duration, #wc_bookings_field_resource").change(function(){var b=a(this).closest("form").find(".picker");d(b)})});